-- [VI] 인덱스 : SELECT(조회) 속도를 높이기 위해

DROP TABLE EMP01;

CREATE TABLE EMP01 AS SELECT * FROM EMP; -- EMP테이블의 내용과 같은 EMP01 생성
SELECT * FROM EMP01;  -- 14행
INSERT INTO EMP01 SELECT * FROM EMP01; -- 데이터 뻥튀기1번(28개,) 2번(56개) 
SELECT COUNT(*) FROM EMP01; -- EMP01의 행수
INSERT INTO EMP01 SELECT * FROM EMP01; -- 11번(11만개)
SELECT COUNT(*) FROM EMP01; -- 11만 4천행정도
INSERT INTO EMP01 (EMPNO, ENAME, DEPTNO) VALUES (1111, 'HONG', 50);  -- 서브쿼리로 가져오면서 제약조건이 다 사라졌기때문에 50번부서 입력가능
INSERT INTO EMP01 SELECT * FROM EMP01; -- 1번(22만개), 2번(44만개), 3번(90만개)
SELECT COUNT(*) FROM EMP01; -- 91만 7천행정도

SELECT * FROM EMP01 WHERE ENAME='HONG'; -- 인덱스 생성전 조회시간 : 0.014초

-- 인덱스 생성
CREATE INDEX IDX_EMP01_ENAME ON EMP01 (ENAME); -- 인덱스 생성 시간 0.67초
SELECT * FROM EMP01 WHERE ENAME='HONG'; -- 인덱스 생성전 조회시간 : 0.001초
COMMIT;
INSERT INTO EMP01 SELECT * FROM EMP01; -- 1번(182만개) (39초 - INSERT하고 B트리 조정하는시간): SELECT속도가 빨라지는 대신 INSERT, DELETE속도가 느려짐
SELECT COUNT(*) FROM EMP01; -- 183만 5천행정도
ROLLBACK; -- 롤백 속도도 느려짐. 15초. 

-- 인덱스 삭제
DROP INDEX IDX_EMP01_ENAME;
SELECT * FROM EMP01 WHERE ENAME='HONG'; -- 인덱스 생성전 조회시간 : 0.02초
INSERT INTO EMP01 SELECT * FROM EMP01; -- 1.25초
ROLLBACK; -- 0.18초
DROP TABLE EMP01; -- 테이블 삭제시 해당 테이블의 인덱스도 삭제